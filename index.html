<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Error 1402 - EURUN CDN</title>
    <style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial,sans-serif;color:#404040;line-height:1.5;min-height:100vh;background:#f8f9fa;-webkit-font-smoothing:antialiased}.container{max-width:60rem;margin:0 auto;padding:0 2rem}.header{margin-bottom:2rem;padding:1.5rem 0}.error-title{display:flex;align-items:baseline;gap:2rem;margin-bottom:1rem}.error-code{font-size:4.5rem;font-weight:200;color:#404040;margin:0;letter-spacing:-0.02em}.ray-info{font-family:monaco,courier,monospace;font-size:.9rem;color:#999;font-weight:400;margin-top:.5rem;letter-spacing:.025em}.ray-id{cursor:pointer;transition:color .2s}.ray-id:hover{color:#0051c3}.error-description{font-size:1.125rem;color:#666;font-weight:400;margin:0;line-height:1.6;max-width:600px;opacity:.9}.content{display:grid;grid-template-columns:1fr 1fr;gap:3rem;margin-bottom:2rem}.section h2{font-size:1.875rem;font-weight:400;color:#404040;margin-bottom:1rem}.section p{font-size:.95rem;line-height:1.5;color:#6b7280;margin-bottom:.75rem}.section strong{font-weight:600;color:#404040}.ip-section{background:#fff;border-radius:.5rem;padding:1.5rem;box-shadow:0 1px 3px rgba(0,0,0,.1);margin-bottom:2rem}.ip-header{display:flex;align-items:center;gap:.75rem;margin-bottom:1rem}.ip-icon{width:1.25rem;height:1.25rem;background:#0051c3;border-radius:.25rem;display:flex;align-items:center;justify-content:center;color:#fff;font-size:.75rem}.ip-title{font-weight:600;color:#404040}.ip-sources{display:flex;gap:.5rem;flex-wrap:wrap}.ip-source{background:#f8f9fa;border:1px solid #e9ecef;border-radius:.25rem;padding:.5rem .75rem;font-size:.75rem;font-weight:600;transition:all .2s}.ip-source.success{background:#d4edda;border-color:#c3e6cb;color:#155724}.ip-source.error{background:#f8d7da;border-color:#f5c6cb;color:#721c24}.footer{text-align:center;color:#999;font-size:.8125rem;border-top:1px solid #e9ecef;padding-top:2rem;margin-top:2rem}.footer-line{margin-bottom:.5rem}.footer strong{color:#404040;font-weight:600}.footer a{color:#0051c3;text-decoration:none;transition:color .15s ease}.footer a:hover{color:#ee730a}.loading{display:inline-block;width:.75rem;height:.75rem;border:2px solid #e9ecef;border-top:2px solid #0051c3;border-radius:50%;animation:spin 1s linear infinite;margin-right:.5rem}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.lang-select{position:fixed;top:12px;right:16px;background:#fff;border:1px solid #e9ecef;border-radius:6px;padding:.25rem .5rem;font-size:.85rem;color:#404040}@media (max-width:768px){.error-code{font-size:3.5rem}.error-title{flex-direction:column;align-items:flex-start;gap:.5rem}.ray-info{margin-top:0}.content{grid-template-columns:1fr;gap:2rem}.container{padding:0 1rem}}</style>
</head>

<body>
    <select id="lang-select" class="lang-select" aria-label="Language"></select>
    <span id="lang-loading" style="position:fixed;top:14px;right:140px;font-size:0.8rem;color:#666;display:none;">Loading‚Ä¶</span>
    <!-- Hidden baseline i18n values for dynamic labels (English baseline) -->
    <div id="i18n-baseline" style="display:none;">
        <span data-i18n="ip_source_failed">Failed</span>
        <span data-i18n="copied">Copied!</span>
        <span data-i18n="detecting">Detecting...</span>
        <span data-i18n="sep">: </span>
    </div>
    <div class="container">
        <div class="header">
            <div class="error-title">
                <h1 class="error-code" data-i18n="error_code">Error 1402</h1>
                <div class="ray-info"><span id="ray-prefix" data-i18n="ray_prefix">Ray ID:</span> <span class="ray-id" id="ray-id"></span> ‚Ä¢ <span id="timestamp"></span>
                </div>
            </div>
            <h2 class="error-description" data-i18n="error_description">An unexpected error occurred. You may not have the necessary permissions to
                access this page.</h2>
        </div>
        <div class="ip-section">
            <div class="ip-header">
                <div class="ip-icon">üåê</div>
                <div class="ip-title" data-i18n="ip_title">Your IP Address</div>
            </div>
            <div class="ip-sources" id="ip-sources">
                <div class="ip-source"><span class="loading"></span>Detecting...</div>
            </div>
        </div>
        <div class="content">
            <div class="section">
                <h2 data-i18n="what_happened">What happened?</h2>
                <p data-i18n="what_happened_p1">You've requested a page on a website that is on the <strong>EURUN CDN network</strong>. The host is
                    configured with access restrictions, and you may not have the necessary permissions to access this
                    page.</p>
                <p data-i18n="what_happened_p2">This could be due to security policies, geographic restrictions, or server configuration issues on
                    the <strong>EURUN CDN</strong> network.</p>
            </div>
            <div class="section">
                <h2 data-i18n="what_can_i_do">What can I do?</h2>
                <p data-i18n="what_can_i_do_p1">If you are a visitor of this website, please try again in a few minutes.</p>
                <p data-i18n="what_can_i_do_p2">If you are the owner of this website, check your DNS settings and security configurations.</p>
            </div>
        </div>
        <div class="footer">
            <div class="footer-line footer-line-1" data-i18n="footer_line1">Performance & security by <strong>EURUN CDN</strong> ‚Ä¢ Operated by <strong>HKTSE
                    s.r.o.</strong></div>
            <div class="footer-line footer-line-2" data-i18n="footer_line2">Holandsk√° 49/4, 10100 Praha, Czech Republic ‚Ä¢ Contact: <a
                    href="mailto:info@hktse.eu.org">info@hktse.eu.org</a></div>
        </div>
    </div>
    <script>
        // Optional debug banner for i18n when using ?debug=i18n
        const DEBUG_I18N = new URLSearchParams(window.location.search).get('debug') === 'i18n';
    // Lazy-loaded i18n: language JSON files under assets/i18n/<code>.json
        const languageMeta = {
            en: 'English', zh: '‰∏≠Êñá', es: 'Espa√±ol', fr: 'Fran√ßais', de: 'Deutsch',
            ja: 'Êó•Êú¨Ë™û', ko: 'ÌïúÍµ≠Ïñ¥', ru: '–†—É—Å—Å–∫–∏–π', ar: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©', pt: 'Portugu√™s',
            it: 'Italiano', nl: 'Nederlands', sv: 'Svenska', no: 'Norsk', pl: 'Polski',
            tr: 'T√ºrk√ße', hi: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä', th: '‡πÑ‡∏ó‡∏¢', vi: 'Ti·∫øng Vi·ªát', id: 'Bahasa Indonesia',
            he: '◊¢◊ë◊®◊ô◊™', uk: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞', cs: 'ƒåe≈°tina', ro: 'Rom√¢nƒÉ', el: 'ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨',
            hu: 'Magyar', da: 'Dansk', fi: 'Suomi', bg: '–ë—ä–ª–≥–∞—Ä—Å–∫–∏', sk: 'Slovenƒçina',
            ca: 'Catal√†', ms: 'Bahasa Melayu', fil: 'Filipino'
        };
        const supportedCodes = Object.keys(languageMeta);
        const rtlLangs = new Set(['ar', 'he', 'fa', 'ur']);

        const i18nCache = new Map();
        // Remote bases for language packs (mirrors). Order matters.
        const LANG_BASES = [
            'https://cdn.jsdelivr.net/gh/yuanweize/Error-1402@main/assets/i18n/',
            'https://raw.githubusercontent.com/yuanweize/Error-1402/main/assets/i18n/'
        ];
        // Simple persistent cache in localStorage
        const I18N_LS_VERSION = 'v1';
        const I18N_CACHE_TTL = 7 * 24 * 60 * 60 * 1000; // 7 days
        const lsKey = (code) => `i18n:${code}:${I18N_LS_VERSION}`;

        // Central i18n map (key -> selector + mode). Reused for baseline capture and DOM updates.
        const I18N_MAP = [
            ['error_code', '.error-code', 'text'],
            ['ray_prefix', '#ray-prefix', 'text'],
            ['ip_title', '.ip-title', 'text'],
            ['error_description', '.error-description', 'text'],
            ['what_happened', '[data-i18n=what_happened]', 'text'],
            ['what_happened_p1', '[data-i18n=what_happened_p1]', 'html'],
            ['what_happened_p2', '[data-i18n=what_happened_p2]', 'html'],
            ['what_can_i_do', '[data-i18n=what_can_i_do]', 'text'],
            ['what_can_i_do_p1', '[data-i18n=what_can_i_do_p1]', 'text'],
            ['what_can_i_do_p2', '[data-i18n=what_can_i_do_p2]', 'text'],
            ['footer_line1', '.footer-line-1', 'html'],
            ['footer_line2', '.footer-line-2', 'html'],
            // dynamic labels from hidden baseline bucket
            ['ip_source_failed', '#i18n-baseline [data-i18n=ip_source_failed]', 'text'],
            ['copied', '#i18n-baseline [data-i18n=copied]', 'text'],
            ['detecting', '#i18n-baseline [data-i18n=detecting]', 'text'],
            ['sep', '#i18n-baseline [data-i18n=sep]', 'text']
        ];

        // Capture English baseline from DOM (used when currentLang is 'en' or when translations are unavailable)
        const baseline = {};
        function captureBaseline() {
            baseline.title = document.title || '';
            for (const [key, sel, mode] of I18N_MAP) {
                const el = document.querySelector(sel);
                if (!el) continue;
                baseline[key] = mode === 'html' ? el.innerHTML : (el.textContent || '').trim();
            }
        }

        async function fetchWithTimeout(url, opts = {}, timeoutMs = 5000) {
            const ctrl = new AbortController();
            const id = setTimeout(() => ctrl.abort(), timeoutMs);
            try {
                const res = await fetch(url, { ...opts, signal: ctrl.signal, headers: { 'Accept': 'application/json' } });
                return res;
            } finally {
                clearTimeout(id);
            }
        }

        async function loadLangJson(code) {
            if (code === 'en') return null; // English uses DOM baseline
            if (i18nCache.has(code)) return i18nCache.get(code);
            // Try localStorage (TTL)
            try {
                const raw = localStorage.getItem(lsKey(code));
                if (raw) {
                    const obj = JSON.parse(raw);
                    if (obj && obj.t && (Date.now() - obj.t) < I18N_CACHE_TTL && obj.data) {
                        i18nCache.set(code, obj.data);
                        return obj.data;
                    }
                }
            } catch {}
            // Fetch from mirrors
            for (const base of LANG_BASES) {
                try {
                    const res = await fetchWithTimeout(`${base}${code}.json`);
                    if (!res.ok) throw new Error('HTTP ' + res.status);
                    const json = await res.json();
                    i18nCache.set(code, json);
                    try { localStorage.setItem(lsKey(code), JSON.stringify({ t: Date.now(), data: json })); } catch {}
                    return json;
                } catch {}
            }
            i18nCache.set(code, null);
            return null;
        }

        async function getStrings(code) {
            // English uses DOM baseline only; others merge: exact -> base
            if (code === 'en') return null;
            const exact = await loadLangJson(code);
            const baseCode = code.includes('-') ? code.split('-')[0] : code;
            const base = code !== baseCode ? await loadLangJson(baseCode) : exact;
            return Object.assign({}, base || {}, exact || {});
        }

        function resolveLangFromNavigator() {
            const prefs = (navigator.languages && navigator.languages.length ? navigator.languages : [navigator.language])
                .filter(Boolean)
                .map(s => s.toLowerCase());
            // For each preferred tag, try exact first, then its base before moving to the next
            for (const tag of prefs) {
                if (supportedCodes.includes(tag)) return tag;
                const base = tag.split('-')[0];
                if (supportedCodes.includes(base)) return base;
            }
            return 'en';
        }

        function getDefaultLang() {
            const saved = localStorage.getItem('lang');
            const pinned = localStorage.getItem('langPinned') === '1';
            // Only honor saved language if user explicitly pinned it (selected via UI)
            if (pinned && saved && supportedCodes.includes(saved)) return saved;
            const nav = resolveLangFromNavigator();
            return supportedCodes.includes(nav) ? nav : 'en';
        }

        let currentLang = getDefaultLang();
        if (DEBUG_I18N) {
            console.info('[i18n] navigator.language =', navigator.language);
            console.info('[i18n] navigator.languages =', navigator.languages);
            console.info('[i18n] resolved =', resolveLangFromNavigator());
            console.info('[i18n] saved/langPinned =', localStorage.getItem('lang'), localStorage.getItem('langPinned'));
            console.info('[i18n] initial currentLang =', currentLang);
        }
        let currentStrings = {};

        function t(key) {
            if (currentStrings && key in currentStrings) return currentStrings[key];
            if (key in baseline) return baseline[key];
            return key;
        }

        function sep() {
            return (currentStrings && 'sep' in currentStrings) ? currentStrings.sep : (baseline.sep || ': ');
        }

        function setText(selector, key) {
            const el = document.querySelector(selector);
            if (el) el.textContent = t(key);
        }

        function setHTML(selector, key) {
            const el = document.querySelector(selector);
            if (el) el.innerHTML = t(key);
        }

        function applyI18nToDom() {
            for (const [key, sel, mode] of I18N_MAP) {
                if (!sel) continue;
                if (mode === 'html') setHTML(sel, key); else setText(sel, key);
            }
        }

        function buildLangSelector() {
            const sel = document.getElementById('lang-select');
            if (!sel) return;
            sel.innerHTML = '';
            const codes = [...supportedCodes].sort((a, b) => languageMeta[a].localeCompare(languageMeta[b]));
            for (const code of codes) {
                sel.append(new Option(languageMeta[code], code, false, currentLang === code));
            }
        }

        async function applyI18nAsync() {
            const loadingEl = document.getElementById('lang-loading');
            if (loadingEl) loadingEl.style.display = 'inline';
            currentStrings = await getStrings(currentLang);
            if (DEBUG_I18N) {
                console.info('[i18n] apply lang =', currentLang, 'loaded pack =', currentStrings ? 'yes' : 'no');
                // Small floating debug panel
                let dbg = document.getElementById('i18n-debug');
                if (!dbg) {
                    dbg = document.createElement('div');
                    dbg.id = 'i18n-debug';
                    dbg.style.cssText = 'position:fixed;left:12px;top:12px;background:#fff;border:1px solid #e9ecef;border-radius:6px;padding:8px 10px;font-size:12px;color:#333;box-shadow:0 1px 3px rgba(0,0,0,.1);z-index:9999;max-width:320px;';
                    document.body.appendChild(dbg);
                }
                dbg.innerHTML = '<strong>i18n debug</strong><br>' +
                    'navigator.language: ' + (navigator.language || '') + '<br>' +
                    'navigator.languages: ' + (navigator.languages || []).join(', ') + '<br>' +
                    'resolved: ' + resolveLangFromNavigator() + '<br>' +
                    'currentLang: ' + currentLang + '<br>' +
                    'pack loaded: ' + (currentStrings ? 'yes' : 'no');
            }
            document.documentElement.lang = currentLang;
            document.documentElement.dir = rtlLangs.has(currentLang) ? 'rtl' : 'ltr';
            document.title = t('title');
            applyI18nToDom();
            buildLangSelector();
            updateIpSourceLabels();
            if (loadingEl) loadingEl.style.display = 'none';
        }

        const ipServices = [
            { name: 'IPIP.net', url: 'https://myip.ipip.net/json', extractIp: d => d.data?.ip },
            { name: 'IPInfo.io', url: 'https://ipinfo.io/json', extractIp: d => d.ip },
            { name: 'IPify', url: 'https://api.ipify.org?format=json', extractIp: d => d.ip }
        ];
        const serviceId = (name) => name.toLowerCase().replace(/[^a-z0-9]+/g, '');

        async function fetchUserIp() {
            const container = document.getElementById('ip-sources');
            container.innerHTML = '';
            ipServices.forEach(service => {
                const el = document.createElement('div');
                el.className = 'ip-source';
                el.textContent = `${service.name}${sep()}${t('detecting')}`;
                el.id = serviceId(service.name);
                container.appendChild(el);
            });
            const results = await Promise.allSettled(ipServices.map(async service => {
                try {
                    const ctrl = new AbortController();
                    const timeout = setTimeout(() => ctrl.abort(), 3000);
                    const res = await fetch(service.url, { signal: ctrl.signal, headers: { 'Accept': 'application/json' } });
                    clearTimeout(timeout);
                    const data = await res.json();
                    const ip = service.extractIp(data);
                    if (ip && /^(\d{1,3}\.){3}\d{1,3}$/.test(ip)) {
                        return { name: service.name, ip };
                    }
                    throw new Error('Invalid IP');
                } catch (e) {
                    return { name: service.name, error: true };
                }
            }));
            results.forEach((result, i) => {
                const el = document.getElementById(serviceId(ipServices[i].name));
                if (result.status === 'fulfilled' && result.value.ip) {
                    el.className = 'ip-source success';
                    el.dataset.ip = result.value.ip;
                    el.textContent = `${ipServices[i].name}${sep()}${result.value.ip}`;
                } else {
                    el.className = 'ip-source error';
                    el.textContent = `${ipServices[i].name}${sep()}${t('ip_source_failed')}`;
                }
            });
        }
        function updateIpSourceLabels() {
            const container = document.getElementById('ip-sources');
            if (!container) return;
            ipServices.forEach(service => {
                const id = serviceId(service.name);
                const el = document.getElementById(id);
                if (!el) return;
                if (el.classList.contains('success')) {
                    const ip = el.dataset.ip || '';
                    if (ip) el.textContent = `${service.name}${sep()}${ip}`;
                } else if (el.classList.contains('error')) {
                    el.textContent = `${service.name}${sep()}${t('ip_source_failed')}`;
                } else {
                    el.textContent = `${service.name}${sep()}${t('detecting')}`;
                }
            });
        }
        function generateRayId() {
            const now = Date.now();
            const hex = now.toString(16);
            const rand = Math.random().toString(16).slice(2, 10);
            return `${hex}${rand}`.slice(0, 16);
        }
        function formatTime() {
            return new Date().toISOString().replace('T', ' ').slice(0, 19) + ' UTC';
        }
        document.addEventListener('click', e => {
            if (e.target.id === 'ray-id') {
                navigator.clipboard?.writeText(e.target.textContent).then(() => {
                    const orig = e.target.textContent;
                    e.target.textContent = t('copied');
                    e.target.style.color = '#28a745';
                    setTimeout(() => {
                        e.target.textContent = orig;
                        e.target.style.color = '';
                    }, 1000);
                });
            }
        });
        // Initialize lang selector and i18n
        const langSelect = document.getElementById('lang-select');
        // Capture English baseline before any mutations
        captureBaseline();
        langSelect.addEventListener('change', (e) => {
            currentLang = e.target.value;
            localStorage.setItem('lang', currentLang);
            localStorage.setItem('langPinned', '1');
            applyI18nAsync();
        });
        applyI18nAsync();

        document.getElementById('ray-id').textContent = generateRayId();
        document.getElementById('timestamp').textContent = formatTime();
        fetchUserIp();
    </script>
</body>

</html>